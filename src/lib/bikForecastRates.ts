/**
 * BiK Forecast Rates by Tax Year and CO2 Band
 * Source: HMRC published rates via Tusker Cars and Santander Consumer
 * Updated: January 2025
 * 
 * All rates are decimal (e.g., 0.02 = 2%)
 */

export interface BikForecastRates {
  [band: string]: {
    [taxYear: string]: number;
  };
}

export const BIK_FORECAST_RATES: BikForecastRates = {
  // Electric vehicles (0g CO2)
  'electric': {
    '2024/25': 0.02,
    '2025/26': 0.03,
    '2026/27': 0.04,
    '2027/28': 0.05,
  },
  
  // Plug-in Hybrids (1-50g CO2) - Most common PHEVs
  // Used for all "Hybrid" selections in our calculator
  'hybrid_1_50': {
    '2024/25': 0.05,
    '2025/26': 0.06,
    '2026/27': 0.07,
    '2027/28': 0.08,
  },
  
  // 51-54g CO2
  'co2_51_54': {
    '2024/25': 0.08,
    '2025/26': 0.09,
    '2026/27': 0.10,
    '2027/28': 0.11,
  },
  
  // 55-59g CO2
  'co2_55_59': {
    '2024/25': 0.12,
    '2025/26': 0.13,
    '2026/27': 0.14,
    '2027/28': 0.15,
  },
  
  // 60-64g CO2
  'co2_60_64': {
    '2024/25': 0.13,
    '2025/26': 0.14,
    '2026/27': 0.15,
    '2027/28': 0.16,
  },
  
  // 65-69g CO2
  'co2_65_69': {
    '2024/25': 0.14,
    '2025/26': 0.15,
    '2026/27': 0.16,
    '2027/28': 0.17,
  },
  
  // 70-74g CO2
  'co2_70_74': {
    '2024/25': 0.15,
    '2025/26': 0.16,
    '2026/27': 0.17,
    '2027/28': 0.18,
  },
  
  // 75-79g CO2
  'co2_75_79': {
    '2024/25': 0.16,
    '2025/26': 0.17,
    '2026/27': 0.18,
    '2027/28': 0.19,
  },
  
  // 80-84g CO2
  'co2_80_84': {
    '2024/25': 0.17,
    '2025/26': 0.18,
    '2026/27': 0.19,
    '2027/28': 0.20,
  },
  
  // 85-89g CO2
  'co2_85_89': {
    '2024/25': 0.18,
    '2025/26': 0.19,
    '2026/27': 0.20,
    '2027/28': 0.21,
  },
  
  // 90-94g CO2
  'co2_90_94': {
    '2024/25': 0.19,
    '2025/26': 0.20,
    '2026/27': 0.21,
    '2027/28': 0.22,
  },
  
  // 95-99g CO2
  'co2_95_99': {
    '2024/25': 0.20,
    '2025/26': 0.21,
    '2026/27': 0.22,
    '2027/28': 0.23,
  },
  
  // 100-104g CO2
  'co2_100_104': {
    '2024/25': 0.21,
    '2025/26': 0.22,
    '2026/27': 0.23,
    '2027/28': 0.24,
  },
  
  // 105-109g CO2
  'co2_105_109': {
    '2024/25': 0.22,
    '2025/26': 0.23,
    '2026/27': 0.24,
    '2027/28': 0.25,
  },
  
  // 110-114g CO2
  'co2_110_114': {
    '2024/25': 0.23,
    '2025/26': 0.24,
    '2026/27': 0.25,
    '2027/28': 0.26,
  },
  
  // 115-119g CO2
  'co2_115_119': {
    '2024/25': 0.24,
    '2025/26': 0.25,
    '2026/27': 0.26,
    '2027/28': 0.27,
  },
  
  // 120-124g CO2
  'co2_120_124': {
    '2024/25': 0.25,
    '2025/26': 0.26,
    '2026/27': 0.27,
    '2027/28': 0.28,
  },
  
  // 125-129g CO2
  'co2_125_129': {
    '2024/25': 0.26,
    '2025/26': 0.27,
    '2026/27': 0.28,
    '2027/28': 0.29,
  },
  
  // 130-134g CO2
  'co2_130_134': {
    '2024/25': 0.27,
    '2025/26': 0.28,
    '2026/27': 0.29,
    '2027/28': 0.30,
  },
  
  // 135-139g CO2
  'co2_135_139': {
    '2024/25': 0.28,
    '2025/26': 0.29,
    '2026/27': 0.30,
    '2027/28': 0.31,
  },
  
  // 140-144g CO2
  'co2_140_144': {
    '2024/25': 0.29,
    '2025/26': 0.30,
    '2026/27': 0.31,
    '2027/28': 0.32,
  },
  
  // 145-149g CO2
  'co2_145_149': {
    '2024/25': 0.30,
    '2025/26': 0.31,
    '2026/27': 0.32,
    '2027/28': 0.33,
  },
  
  // 150-154g CO2
  'co2_150_154': {
    '2024/25': 0.31,
    '2025/26': 0.32,
    '2026/27': 0.33,
    '2027/28': 0.34,
  },
  
  // 155-159g CO2
  'co2_155_159': {
    '2024/25': 0.32,
    '2025/26': 0.33,
    '2026/27': 0.34,
    '2027/28': 0.35,
  },
  
  // 160-164g CO2
  'co2_160_164': {
    '2024/25': 0.33,
    '2025/26': 0.34,
    '2026/27': 0.35,
    '2027/28': 0.36,
  },
  
  // 165-169g CO2
  'co2_165_169': {
    '2024/25': 0.34,
    '2025/26': 0.35,
    '2026/27': 0.36,
    '2027/28': 0.37,
  },
  
  // 170g+ CO2 (Maximum rate)
  'co2_170_plus': {
    '2024/25': 0.37,
    '2025/26': 0.37,
    '2026/27': 0.37,
    '2027/28': 0.37,
  },
};

/**
 * Get the BiK band key based on fuel type and CO2 emissions
 */
export const getBikBandKey = (
  fuelType: 'electric' | 'hybrid' | 'petrol',
  co2?: number
): string => {
  // Electric vehicles
  if (fuelType === 'electric') return 'electric';
  
  // Hybrid vehicles - use 1-50g band (most common PHEVs)
  if (fuelType === 'hybrid') return 'hybrid_1_50';
  
  // Petrol/Diesel - determine band from CO2 emissions
  if (!co2 || co2 <= 0) return 'co2_75_79'; // Fallback default
  
  if (co2 <= 50) return 'hybrid_1_50';
  if (co2 <= 54) return 'co2_51_54';
  if (co2 <= 59) return 'co2_55_59';
  if (co2 <= 64) return 'co2_60_64';
  if (co2 <= 69) return 'co2_65_69';
  if (co2 <= 74) return 'co2_70_74';
  if (co2 <= 79) return 'co2_75_79';
  if (co2 <= 84) return 'co2_80_84';
  if (co2 <= 89) return 'co2_85_89';
  if (co2 <= 94) return 'co2_90_94';
  if (co2 <= 99) return 'co2_95_99';
  if (co2 <= 104) return 'co2_100_104';
  if (co2 <= 109) return 'co2_105_109';
  if (co2 <= 114) return 'co2_110_114';
  if (co2 <= 119) return 'co2_115_119';
  if (co2 <= 124) return 'co2_120_124';
  if (co2 <= 129) return 'co2_125_129';
  if (co2 <= 134) return 'co2_130_134';
  if (co2 <= 139) return 'co2_135_139';
  if (co2 <= 144) return 'co2_140_144';
  if (co2 <= 149) return 'co2_145_149';
  if (co2 <= 154) return 'co2_150_154';
  if (co2 <= 159) return 'co2_155_159';
  if (co2 <= 164) return 'co2_160_164';
  if (co2 <= 169) return 'co2_165_169';
  
  // 170g+ CO2
  return 'co2_170_plus';
};

